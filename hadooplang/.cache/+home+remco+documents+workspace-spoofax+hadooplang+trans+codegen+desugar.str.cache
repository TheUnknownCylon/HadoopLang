Module("trans/codegen/desugar",[Imports([Import("include/Hadooplang"),Import("trans/index"),Import("trans/types/operators"),Import("trans/types/typeof")]),Rules([SDefNoArgs("desugar-compiler",Call(SVar("innermost"),[CallNoArgs(SVar("desugar-compile"))]))]),Rules([RDefNoArgs("desugar-compile",Rule(NoAnnoList(Op("DatasetSetVar",[NoAnnoList(Op("DatasetRef",[Var("varref")])),Var("expr")])),Var("res'"),Seq(Assign(NoAnnoList(Op("OpExp",[NoAnnoList(Op("OpPlus",[])),NoAnnoList(Op("OpExp",[NoAnnoList(Op("OpPlus",[])),Wld,Wld])),Wld])),Var("expr")),Seq(BA(CallNoArgs(SVar("equal")),NoAnnoList(Tuple([NoAnnoList(Op("String",[])),App(CallNoArgs(SVar("type-type-of")),App(CallNoArgs(SVar("get-node")),Var("varref")))]))),Seq(BA(CallNoArgs(SVar("equal")),NoAnnoList(Tuple([NoAnnoList(Op("String",[])),App(CallNoArgs(SVar("type-type-of")),Var("expr"))]))),Assign(Var("res'"),App(CallT(SVar("desugar-compile-plus"),[],[Var("varref")]),Var("expr")))))))),RDefT("desugar-compile-plus",[],[DefaultVarDec("varname")],Rule(NoAnnoList(Op("OpExp",[NoAnnoList(Op("OpPlus",[])),Var("a"),Var("b")])),App(CallNoArgs(SVar("concat")),NoAnnoList(List([Var("plusa"),NoAnnoList(List([Var("plusb")]))]))),Seq(Assign(Var("plusa"),App(CallT(SVar("desugar-compile-plus"),[],[Var("varname")]),Var("a"))),Assign(Var("plusb"),NoAnnoList(Op("DatasetSetVar",[NoAnnoList(Op("DatasetRef",[Var("varname")])),NoAnnoList(Op("OpExp",[NoAnnoList(Op("OpPlus",[])),NoAnnoList(Op("DatasetRef",[Var("varname")])),Var("b")]))])))))),RDefT("desugar-compile-plus",[],[DefaultVarDec("varname")],Rule(NoAnnoList(Op("DatasetRef",[Var("x")])),NoAnnoList(List([])),BA(CallNoArgs(SVar("equal")),NoAnnoList(Tuple([Var("x"),Var("varname")])))))])])